---
import MotionReveal from "./MotionReveal";
import CTAButton from "./CTAButton";

interface ProjectFrontmatter {
  title: string;
  stack: string[];
  problem: string;
  result: string;
  cover: string;
  role: string;
  impact?: string;
}

interface Props {
  project: ProjectFrontmatter;
  slug: string;
  revealDelay?: number;
}

const { project, slug, revealDelay = 0 } = Astro.props;
---

<MotionReveal client:only="react" delay={revealDelay}>
  <article
    class="group grid gap-6 rounded-xl border border-divider/40 bg-surface/90 p-6 shadow-subtle transition-transform duration-300 motion-safe:hover:-translate-y-[6px] motion-safe:hover:border-accent/50 motion-safe:hover:shadow-soft"
  >
    <img
      src={project.cover}
      alt={`Cuplikan proyek ${project.title}`}
      class="h-48 w-full rounded-lg object-cover transition-transform duration-500 ease-[cubic-bezier(0.16,1,0.3,1)] motion-safe:group-hover:scale-[1.02]"
      loading={revealDelay === 0 ? "eager" : "lazy"}
      decoding="async"
      fetchpriority={revealDelay === 0 ? "high" : "auto"}
    />
    <div class="space-y-4">
      <div class="flex flex-wrap items-center gap-2 text-xs uppercase tracking-[0.3em] text-accent">
        <span>{project.role}</span>
        {
          project.stack.map((stack: string) => (
            <span class="rounded-full border border-divider/60 bg-bg/60 px-2 py-1 normal-case tracking-normal text-text2">
              {stack}
            </span>
          ))
        }
      </div>
      <div class="space-y-2">
        <h3 class="font-heading text-2xl font-semibold text-text">{project.title}</h3>
        <p class="text-sm text-text2">{project.problem}</p>
        <p class="text-sm text-success">{project.impact ?? project.result}</p>
      </div>
      <CTAButton client:load href={`/project/${slug}`} variant="ghost">
        Lihat studi kasus
      </CTAButton>
    </div>
  </article>
</MotionReveal>
