<div class="preloader" data-preloader aria-live="polite">
  <div class="preloader__inner">
    <span class="preloader__tag">loading</span>
    <span class="sr-only">Memuat pengalaman Noah Isme</span>
    <div class="preloader__letters" aria-hidden="true">
      {
        "noahisme".split("").map((letter, index) => (
          <span class="preloader__letter" style={`--index:${index}`}>
            {letter}
          </span>
        ))
      }
    </div>
  </div>
</div>

<script is:inline>
  const MIN_DURATION = 1500;
  const FAILSAFE_DURATION = 4000;
  const overlay = document.querySelector("[data-preloader]");
  const start = performance.now();

  if (overlay) {
    const finish = () => {
      const elapsed = performance.now() - start;
      const remaining = Math.max(0, MIN_DURATION - elapsed);
      window.setTimeout(() => {
        overlay.classList.add("is-leaving");
        overlay.addEventListener(
          "transitionend",
          () => {
            overlay.remove();
          },
          { once: true }
        );
      }, remaining);
    };

    if (document.readyState === "complete") {
      finish();
    } else {
      window.addEventListener("load", finish, { once: true });
    }

    window.setTimeout(() => {
      if (!overlay.classList.contains("is-leaving")) {
        finish();
      }
    }, FAILSAFE_DURATION);
  }
</script>

<style>
  .preloader {
    position: fixed;
    inset: 0;
    z-index: 9999;
    display: grid;
    place-items: center;
    background: radial-gradient(circle at top, rgba(30, 41, 59, 0.92), rgba(15, 23, 42, 0.96));
    transition:
      opacity 0.6s cubic-bezier(0.16, 1, 0.3, 1),
      transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
    will-change: opacity, transform;
  }

  .preloader.is-leaving {
    opacity: 0;
    transform: scale(0.96);
    pointer-events: none;
  }

  .preloader__inner {
    display: grid;
    gap: 0.75rem;
    padding: 1.75rem 2rem;
    border-radius: 32px;
    border: 1px solid rgba(148, 163, 184, 0.25);
    background: rgba(2, 6, 23, 0.55);
    backdrop-filter: blur(16px);
    text-transform: uppercase;
    letter-spacing: 0.4em;
  }

  .preloader__tag {
    font-size: 0.7rem;
    font-weight: 500;
    color: rgba(226, 232, 240, 0.75);
    text-align: center;
  }

  .preloader__letters {
    display: flex;
    gap: 0.55rem;
    justify-content: center;
    font-family: var(--font-heading, "Inter", sans-serif);
    font-size: clamp(1.4rem, 2vw + 1rem, 2.8rem);
    color: #f8fafc;
  }

  .preloader__letter {
    display: inline-block;
    opacity: 0;
    transform: translateY(24px) scale(0.92);
    animation: letterReveal 1.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    animation-delay: calc(var(--index) * 90ms);
  }

  @keyframes letterReveal {
    0% {
      opacity: 0;
      transform: translateY(24px) scale(0.92);
      filter: blur(4px);
    }
    40% {
      opacity: 1;
      transform: translateY(-4px) scale(1.02);
      filter: blur(0px);
    }
    70% {
      transform: translateY(0px) scale(1);
    }
    100% {
      opacity: 1;
      transform: translateY(0) scale(1);
      filter: blur(0);
    }
  }

  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  @media (prefers-reduced-motion: reduce) {
    .preloader {
      transition: opacity 0.3s ease;
    }

    .preloader__letter {
      animation: none;
      opacity: 1;
      transform: none;
      filter: none;
    }
  }
</style>
